/*! knockstrap 0.4.0 | (c) 2014 Artem Stepanyuk |  http://www.opensource.org/licenses/mit-license */
!function(a,b){"use strict";"function"==typeof require&&"object"==typeof exports&&"object"==typeof module?b(require("knockout"),require("jquery")):"function"==typeof define&&define.amd?define(a,["knockout","jQuery"],b):b(ko,$)}("knockstrap",function(a,b){"use strict";a.utils.uniqueId=function(){var a={"ks-unique-":0};return function(b){return b=b||"ks-unique-",a[b]||(a[b]=0),b+a[b]++}}(),a.utils.unwrapProperties=function(b){if(null===b||"object"!=typeof b)return b;var c={};return a.utils.objectForEach(b,function(b,d){c[b]=a.unwrap(d)}),c},a.stringTemplateEngine=function(){var b={},c=new a.nativeTemplateEngine;return b.alert='<div class="alert fade in" data-bind="css: type, template: innerTemplate"> </div>',b.alertInner='<button class="close" data-dismiss="alert" aria-hidden="true">&times;</button> <p data-bind="text: message"></p>',b.carousel='<!-- ko template: indicatorsTemplate --> <!-- /ko --> <div class="carousel-inner"> <!-- ko foreach: items --> <div class="item" data-bind="with: $parent.converter($data), css: { active: $index() == 0 }"> <img data-bind="attr: { src: src, alt: alt }"> <div class="container"> <div class="carousel-caption"> <!-- ko template: { name: $parents[1].itemTemplateName, data: $data, templateEngine: $parents[1].templateEngine } --> <!-- /ko --> </div> </div> </div> <!-- /ko --> </div> <!-- ko template: controlsTemplate --> <!-- /ko --> ',b.carouselContent='<div data-bind="text: content"></div>',b.carouselControls='<a class="left carousel-control" data-bind="attr: { href: id }" data-slide="prev"> <span class="icon-prev"></span> </a> <a class="right carousel-control" data-bind="attr: { href: id }" data-slide="next"> <span class="icon-next"></span> </a>',b.carouselIndicators='<ol class="carousel-indicators" data-bind="foreach: items"> <li data-bind="attr: { \'data-target\': $parent.id, \'data-slide-to\': $index }"></li> </ol> ',b.modal='<div class="modal-dialog"> <div class="modal-content"> <div class="modal-header" data-bind="template: headerTemplate"> </div> <div class="modal-body" data-bind="template: bodyTemplate"> </div> <div class="modal-footer" data-bind="template: footerTemplate"> </div> </div> </div>',b.modalBody='<div data-bind="html: content"> </div>',b.modalFooter='<!-- ko if: $data.action --> <a href="#" class="btn btn-primary" data-bind="click: action, html: primaryLabel"></a> <!-- /ko --> <a href="#" class="btn btn-default" data-bind="html: closeLabel" data-dismiss="modal"></a>',b.modalHeader='<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button> <h3 data-bind="text: label"></h3> ',b.progress='<div class="progress-bar" role="progressbar" aria-valuemin="0" aria-valuemax="100" data-bind="style: { width: barWidth }, attr: { \'aria-valuenow\' : value }"> <span class="sr-only"><span data-bind="text: value"></span>% Complete</span> </div> ',a.templateSources.stringTemplate=function(a){this.templateName=a,this.data=function(a,c){return b.data=this.templates.data||{},b.data[this.templateName]=this.templates.data[this.templateName]||{},1===arguments.length?b.data[this.templateName][a]:void(b.data[this.templateName][a]=c)},this.text=function(a){return 0===arguments.length?b[this.templateName]:void(b[this.templateName]=a)}},c.makeTemplateSource=function(b){return new a.templateSources.stringTemplate(b)},c.addTemplate=function(a,c){b[a]=c},c},a.stringTemplateEngine.instance=new a.stringTemplateEngine,a.bindingHandlers.alert={init:function(){return{controlsDescendantBindings:!0}},update:function(c,d,e,f,g){var h,i,j=b(c),k=d(),l=k.template?null:a.stringTemplateEngine.instance,m=a.unwrap(k.template)||"alertInner";if(1===c.nodeType)h=m,i=k.data||{message:k.message},j.addClass("alert fade in").addClass("alert-"+(a.unwrap(k.type)||"info"));else{if(8!==c.nodeType)throw new Error("alert binding should be used with dom elements or ko virtual elements");h="alert",i={innerTemplate:{name:m,data:k.data||{message:k.message},templateEngine:l},type:"alert-"+(a.unwrap(k.type)||"info")}}a.renderTemplate(h,g.createChildContext(i),a.utils.extend({templateEngine:l},k.templateOptions),c)}},a.virtualElements.allowedBindings.alert=!0,a.bindingHandlers.carousel={defaults:{controlsTemplate:{name:"carouselControls",templateEngine:a.stringTemplateEngine.instance,dataConverter:function(b){return{id:a.computed(function(){return"#"+a.unwrap(b.id)})}}},indicatorsTemplate:{name:"carouselIndicators",templateEngine:a.stringTemplateEngine.instance,dataConverter:function(b){return{id:a.computed(function(){return"#"+a.unwrap(b.id)}),items:b.content.data}}},itemTemplate:{name:"carouselContent",templateEngine:a.stringTemplateEngine.instance,converter:function(a){return a}}},init:function(c,d,e,f,g){var h=b(c),i=d(),j=a.bindingHandlers.carousel.defaults,k=function(c,d){var e={name:c.name,data:i[d]&&(i[d].data||i[d].dataConverter&&i[d].dataConverter(i))||c.dataConverter(i)};return b.extend(!0,e,i[d]),i[d]&&i[d].name||(e.templateEngine=a.stringTemplateEngine.instance),e};if(!i.content)throw new Error("content option is required for carousel binding");c.id?i.id=c.id:c.id=i.id?a.unwrap(i.id):i.id=a.utils.uniqueId("ks-carousel-");var l={id:i.id,controlsTemplate:k(j.controlsTemplate,"controls"),indicatorsTemplate:k(j.indicatorsTemplate,"indicators"),items:i.content.data,converter:i.content.converter||j.itemTemplate.converter,itemTemplateName:i.content.name||j.itemTemplate.name,templateEngine:i.content.name?null:a.stringTemplateEngine.instance};return a.renderTemplate("carousel",g.createChildContext(l),{templateEngine:a.stringTemplateEngine.instance},c),h.addClass("carousel slide"),{controlsDescendantBindings:!0}},update:function(c,d){var e=b(c),f=d(),g=a.unwrap(f.options);e.carousel(g)}},a.bindingHandlers.checkbox={init:function(c,d){var e=b(c),f=function(c){setTimeout(function(){var e=b(c.target),f=d(),g=e.val(),h=e.parent().hasClass("active");if(a.unwrap(f)instanceof Array){var i=a.unwrap(f).indexOf(g);h&&-1===i?f.push(g):h||-1===i||f.splice(i,1)}else f(h)},0)};if("buttons"===e.attr("data-toggle")&&e.find("input:checkbox").length){if(!(a.unwrap(d())instanceof Array))throw new Error("checkbox binding should be used only with array or observableArray values in this case");e.on("change","input:checkbox",f)}else{if("checkbox"!==e.attr("type"))throw new Error("checkbox binding should be used only with bootstrap checkboxes");if(!a.isObservable(d()))throw new Error("checkbox binding should be used only with observable values in this case");e.on("change",f)}},update:function(c,d){var e,f=b(c),g=a.unwrap(d());g instanceof Array?"buttons"===f.attr("data-toggle")?f.find("input:checkbox").each(function(a,c){e=-1!==g.indexOf(c.value),b(c).parent().toggleClass("active",e),c.checked=e}):(e=-1!==g.indexOf(f.val()),f.toggleClass("active",e),f.find("input").prop("checked",e)):(e=!!g,f.prop("checked",e),f.parent().toggleClass("active",e))}},a.bindingHandlers.modal={defaults:{headerTemplate:{name:"modalHeader"},bodyTemplate:{name:"modalBody"},footerTemplate:{name:"modalFooter",data:{closeLabel:"Close",primaryLabel:"Ok"}}},init:function(c,d,e,f,g){var h=b(c),i=a.unwrap(d()),j=a.bindingHandlers.modal.defaults,k=a.utils.extend({show:!1},a.utils.unwrapProperties(i.options));if(!i.header||!i.body)throw new Error("header and body options are required for modal binding.");var l={headerTemplate:b.extend(!0,{templateEngine:i.header.name?null:a.stringTemplateEngine.instance},j.headerTemplate,i.header),bodyTemplate:b.extend(!0,{templateEngine:i.body.name?null:a.stringTemplateEngine.instance},j.bodyTemplate,i.body),footerTemplate:b.extend(!0,{templateEngine:i.footer&&i.footer.name?null:a.stringTemplateEngine.instance},j.footerTemplate,i.footer)};return a.renderTemplate("modal",g.createChildContext(l),{templateEngine:a.stringTemplateEngine.instance},c),h.addClass("modal fade").attr("role","dialog"),h.modal(k),h.on("shown.bs.modal",function(){i.visible(!0)}),h.on("hidden.bs.modal",function(){i.visible(!1)}),{controlsDescendantBindings:!0}},update:function(c,d){var e=a.unwrap(d());b(c).modal(a.unwrap(e.visible)?"show":"hide")}};var c="__popoverTemplateKey__",d="__popoverEventHandlerKey__";a.bindingHandlers.popover={init:function(c){var d=b(c);return a.utils.domNodeDisposal.addDisposeCallback(c,function(){d.data("bs.popover")&&d.popover("destroy")}),{controlsDescendantBindings:!0}},update:function(e,f,g,h,i){var j=b(e),k=a.unwrap(f()),l=a.utils.unwrapProperties(k.options||k.template?k.options:k)||{};if(k.template){var m=a.unwrap(k.template),n=a.utils.domData.get(e,c),o=a.unwrap(k.data);n||(n=a.utils.uniqueId("ks-popover-"),a.utils.domData.set(e,c,n)),j.off("shown.bs.popover",a.utils.domData.get(e,d));var p=function(){a.renderTemplate(m,i.createChildContext(o),{},document.getElementById(n))};j.on("shown.bs.popover",p),a.utils.domData.set(e,d,p),l.content='<div id="'+n+'" ></div>',l.html=!0,b(n).is(":visible")&&p()}var q=j.data("bs.popover");q?a.utils.extend(q.options,l):j.popover(l)}},a.bindingHandlers.progress={init:function(c,d){var e=b(c),f=d();if("number"!=typeof a.unwrap(f))throw new Error("progress binding can accept only numbers");var g=a.computed(function(){return a.unwrap(f)+"%"});return a.renderTemplate("progress",{value:f,barWidth:g},{templateEngine:a.stringTemplateEngine.instance},c),e.addClass("progress"),{controlsDescendantBindings:!0}}},a.bindingHandlers.radio={init:function(c,d){var e=b(c);if(!a.isObservable(d()))throw new Error("radio binding should be used only with observable values");e.on("change","input:radio",function(a){setTimeout(function(){var c=b(a.target),e=d(),f=c.val();e(f)},0)})},update:function(c,d){var e,f=b(c).find('input[value="'+a.unwrap(d())+'"]');f.length?(e=f.parent(),e.siblings().removeClass("active"),e.addClass("active"),f.prop("checked",!0)):(e=b(c).find(".active"),e.removeClass("active"),e.find("input").prop("checked",!1))}},a.bindingHandlers.toggle={init:function(c,d){var e=d();if(!a.isObservable(e))throw new Error("toggle binding should be used only with observable values");b(c).on("click",function(){var b=a.unwrap(e);e(!b)})},update:function(b,c){a.utils.toggleDomNodeCssClass(b,"active",a.unwrap(c()))}},a.bindingHandlers.tooltip={init:function(c){var d=b(c);a.utils.domNodeDisposal.addDisposeCallback(c,function(){d.data("bs.tooltip")&&d.tooltip("destroy")})},update:function(c,d){var e=b(c),f=a.unwrap(d()),g=a.utils.unwrapProperties(f),h=e.data("bs.tooltip");h?a.utils.extend(h.options,g):e.tooltip(g)}}});