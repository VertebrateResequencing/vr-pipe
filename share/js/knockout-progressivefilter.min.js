!function(e){"use strict";"function"==typeof require&&"object"==typeof exports&&"object"==typeof module?e(require("knockout"),exports):"function"==typeof define&&define.amd?define(["knockout","exports"],e):e(ko,{})}(function(e){"use strict";e.extenders.progressivefilter=function(t,n){function i(){var e;for(c.unfilteredCollectionIndex;c.unfilteredCollectionIndex<c.unfilteredCollection.length;c.unfilteredCollectionIndex++)if(e=c.unfilteredCollection[c.unfilteredCollectionIndex],e&&t.isFiltered(e)){c.add(e),d++;break}return l++,c.unfilteredCollectionIndex++,c.unfilteredCollectionIndex<c.unfilteredCollection.length&&u>d?void(l>=c.batchSize?(t.valueHasMutated(),l=0,o(i)):(l++,i())):(t.valueHasMutated(),l=0,c.unfilteredCollectionIndex>=r&&(c.unfilteredCollectionIndex=0),c.isFiltering(!1),void 0)}var o=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||function(e){setTimeout(e,4)},l=0,r=0,u=0,d=0,c={};n=n||{},t.progressivefilter=c,c.unfilteredCollection=[],c.unfilteredCollectionIndex=0,c.isFiltering=e.observable(!1),c.filterFunction=n.filterFunction,c.batchSize=Math.max(parseInt(n.batchSize,10),1),c.maxRows=n.maxRows,c.add=n.addFunction||function(e){t.peek().push(e)},c.clear=n.clearFunction||function(){t([])},t.isFiltered=function(e){return!c.filterFunction||c.filterFunction(e)},t.trueLength=e.observable(0),t.filterProgressive=function(e,n){c.unfilteredCollection=e.slice(0);var f,s,a=0;for(r=0,f=0;f<c.unfilteredCollection.length;f++)s=c.unfilteredCollection[f],s&&t.isFiltered(s)&&(a++,r=f);t.trueLength(a),l=0,n&&c.unfilteredCollectionIndex||(c.unfilteredCollectionIndex=0,c.clear(),d=0),u=c.unfilteredCollection.length<c.maxRows()?c.unfilteredCollection.length:c.maxRows(),c.isFiltering.peek()||(c.isFiltering(!0),o(i))}}});